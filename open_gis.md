## OpenGIS
Open Geodata Interoperation Specification，简称OGIS
开放的地理数据互操作规范

OGIS是指在计算机和通信环境下，根据行业标准和接口所建立起来的地理信息系统。

OGIS由开放地理信息系统协会(Open GIS Consortium，简称OGC)提出。

目的是促进采用新的技术和商业方式来提高地理信息处理的互操作性(Interoperability)，它致力于消除地理信息应用（如地理信息系统，遥感，土地信息系统，自动制图/设施管理(AM/FM)系统）之间以及地理应用与其它信息技术应用之间的藩篱，建立一个无“边界”的、分布的、基于构件的地理数据互操作环境。




OpenGIS定义了一组基于数据的服务，而数据的基础是要素（Feature）。

所谓要素简单地说就是一个独立的对象，在地图中可能表现为一个多边形建筑物，在数据库中即一个独立的条目。要素具有两个必要的组成部分，几何信息和属性信息。

OpenGIS将几何信息分为点、边缘、面和几何集合四种：线（Linestring）属于边缘的一个子类，而多边形（Polygon）是面的一个子类。也就是说OpenGIS定义的几何类型并不仅仅是常见的点、线、多边形三种，它提供了更复杂更详细的定义，增强了未来的可扩展性。

另外，几何类型的设计中采用了组合模式（Composite），将几何集合（Geometry Collection）也定义为一种几何类型，类似地，要素集合（FeatureCollection）也是一种要素。

属性信息没有做太大的限制，可以在实际应用中结合具体的实现进行设置。 

相同的几何类型、属性类型的组合成为要素类型（FeatureType），要素类型相同的要素可以被存放在一个数据源中。而一个数据源只能拥有一个要素类型。因此，可以用要素类型来描述一组属性相似的要素。

在面向对象的模型中，完全可以把要素类型理解为一个类，而要素则是类的实例。 通过GIS中间件可以从数据源中取出数据，供WMS服务器和WFS服务器使用。WMS服务器接收请求，根据请求内容的不同，可以返回不同格式的最终数据。例如，WMS可以返回常用图片格式的地图片段供最终用户阅读（类似Google Maps），其中地图是根据一个样式文件（SLD）生成的，它描述了地图的线划粗细，色彩等；WMS也可以返回GeoRSS和KML用来和其它地图服务互通。WFS服务器也可以接收请求，但WFS将返回GML 格式的地理信息数据。GML是一种基于XML的数据格式，它可以完整的再现数据，也是 OpenGIS数据源的重要形式。也就是说，WFS返回的GML可以继续作为数据源。在WFS请求中，OpenGIS定义了一个Filter标准，用来实现对数据的筛选，使WFS更加灵活。另一方面，WFS还支持通过WFS-t提交客户端对数据的修改。通俗地说，WMS是“只读”的，而WFS则是可以读写的。 
















EPSG：European Petroleum Survey Group (EPSG)， https://www.epsg.org/ ， 它成立于1986年，并在2005年重组为OGP(Internation Association of Oil & Gas Producers)，它负责维护并发布坐标参考系统的数据集参数，以及坐标转换描述，该数据集被广泛接受并使用，通过一个Web发布平台进行分发，同时提供了微软Acess数据库的存储文件，通过SQL 脚本文件，mySQL, Oracle 和PostgreSQL等数据库也可使用。



Open Geospatial Consortium (OGC)开放地理空间信息联盟，他们在全球范围内合作建立地理信息技术的开放标准和最佳实践，为地理信息交换的便捷提供技术支持。

OGC自称是一个非盈利的、国际化的、自愿协商的标准化组织，它的主要目的就是制定与空间信息、基于位置服务相关的标准。这些标准就是OGC的“产品”，而这些标准的用处就在于使不同厂商、不同产品之间可以通过统一的接口进行互操作。

在GIS领域，OGC已经是一个比较“官方”的标准化机构了，它不但包括了ESRI、Google、Oracle等业界强势企业作为其成员，同时还和W3C、ISO、IEEE等协会或组织结成合作伙伴关系。因此，OGC的标准虽然并不带有强制性，但是因为其背景和历史的原因，它所制定的标准天然地具有一定的权威性。

事实上我们对OGC和OGC标准并不需要盲目崇拜和迷信，从RESTful服务规范的缺失、KML的空降等可以看出来，OGC还是有一些缺失和不足的地方。




空间参考系统（SRS：spatial reference system）或者叫坐标参考系统（CRS：coordinate reference system）是基于局部的、区域的或者全球的坐标系统，常被用来定位地理实体。空间参考坐标系定义了特定的投影和不同空间参考坐标系之间的转换。OGC的Simple Feature Access使用WKT文本表示空间参考坐标系，这一协议也已经被多个标准的地理信息系统实现。空间参考坐标系可以用SRID整数来表示，包括由OGP定义的EPSG代码。

SRID是一个独一无二的值用来明确标识投影的、非投影的、独立的空间坐标系定义。这些坐标系构成了GIS应用的核心。

事实上所有的主要的空间供应商已经创建了他们自己的SRID实现或者参照一个权威，例如EPSG。

SRIDs是OGC数据库（Simple Features for SQL Specification, Versions 1.1 and 1.2）spatial_ref_sys元数据表的主键。

西安80、北京54、CGCS2000、WGS84坐标系


地理坐标系GCS（Geographic Coordinate System）

两个阶段：

一是用平静的海面描述地球；

二是用虚拟的旋转椭球面描述地球表面。

用平静的海面描述地球就是假设地球表面都是水，且风平浪静，这个面就是大地水准面。

很多人一开始认为这个大地水准面是一个标准的球体，后来发现地球各个地方的引力是有差异的，因此用大地水准面来描述地球表面是不合适的。

椭球面在每个坐标平面上的投影都是椭圆。而旋转椭球面是可以用一个椭圆绕对称轴旋转得到，所以它在某个坐标平面上的投影是个圆。

因此可以这么说：GIS坐标系中的椭球，如果加上高程系，在其内涵上就是GCS（地理坐标系）。其度量单位就是度分秒。

物体均有其质心，处处密度相等的物体的质心在其几何中心。所以，地球只有一个质心，只是测不测的精确的问题而已。由地球的唯一性和客观存在，以地球质心为旋转椭球面的中心的坐标系，叫地心坐标系（地心坐标系又名协议地球坐标系），且唯一。

每个国家都想让地图尽可能准确地描述本国的地形地貌，因此就有国家把质心“移走”，让局部的表面“贴到”该国的国土，使之高程误差尽量减小到最小。这个时候，就出现了所谓的“参心坐标系”。

1. 北京54坐标系是一个参心坐标系，这个坐标系是新中国成立后采用了前苏联的克拉索夫斯基椭球参数，并与前苏联1942年坐标系进行联测，通过计算建立了我国大地坐标系，定名为1954年北京坐标系。但是不要天真的以为这个椭球体的参心在北京，原点在前苏联的普尔科沃。

高程系采用的是56黄海高程系

2. 西安80坐标系还是参心坐标系，由于北京54坐标系的原点离我们国家距离太远，因此在实际使用的过程中不太符合我们国家的实际情况。因此设立了西安80坐标系。西安80坐标系的大地原点设在我国中部的陕西省泾阳县永乐镇，位于西安市西北方向约60公里。采用地球椭球基本参数为1975年国际大地测量与地球物理联合会第十六届大会推荐的数据。

高程系采用的是1985国家高程基准。

3. WGS84坐标系是地心坐标系，全称World Geodetic System-1984，是美国为了解决GPS定位而产生的全球统一的一个坐标系。对应的椭球是WGS84椭球体。

4. CGCS2000坐标系是地心坐标系，其全称为China Geodetic Coordinate System 2000，其原点为包括海洋和大气的整个地球的质量中心。对应的椭球是CGCS2000椭球体。

高程系采用的是1985国家高程基准。

1954北京坐标系和1980西安坐标系都是依赖于传统技术手段在地表观测形成，其原点亦均选在地表并严加看护，仅限用于区域性的定位研究，成果精度偏低、无法满足新时期大地测绘的要求。随着航空航天事业的发展，及空间技术的成熟与广泛应用，1954北京坐标系和1980西安坐标系在成果精度和适用范围越来越难满足国家需求。2000国家大地坐标系，作为一个高精度的、以地球质量中心为原点、动态、实用、统一的大地坐标系应运而生。

CGCS2000椭球和WGS84椭球极为相似，二者采用的参考椭球非常接近，唯有扁率有微小差异。扁率差异引起椭球面上的纬度和高度变化最大达0.1mm。可以说两者相容至厘米级水平，但若一点的坐标精度达不到厘米水平，则不认为CGCS2000和WGS84的坐标是相容的。

仅考虑椭球的差异，两者的结果是一致的，但因2000国家大地坐标系的坐标定义在2000年那一时刻，而大多数应用实际上是不同时间进行定位，因地球上的板体是在不断运动的，不同时刻位于地球不同板块上站点的实际位置是在变化的，已经偏离了2000年的位置。

因此不同时间定位的得到的WGS84坐标不是严格意义下的2000国家大地坐标系。如基于当前框架2009年坐标值与2000国家大地坐标系的相比，最大差0.6m。但对于1:1万以小比例尺的应用，可简单近似地认为是同一坐标系。



地理坐标系(Geographic Coordinate System)，是使用三维球面来定义地球表面位置，以实现通过经纬度对地球表面点位引用的坐标系。一个地理坐标系包括角度测量单位、本初子午线和参考椭球体三部分。在球面系统中，水平线是等纬度线或纬线。垂直线是等经度线或经线。


投影坐标系 (Projection coordinatesystem)，是平面坐标系统，地图单位通常为米，也称非地球投影坐标系统(notearth)，或者是平面坐标。投影坐标系使用基于X,Y值的坐标系统来描述地球上某个点所处的位置。这个坐标系是从地球的近似椭球体投影得到的，它对应于某个地理坐标系。

兰伯特Lambert投影（正轴等角割圆锥投影）

墨卡托Mercator投影（正轴等角圆柱投影）

通用横轴墨卡托UTM

WGS 84 / Pseudo-Mercator

Web Mercator 坐标系使用的投影方法不是严格意义的墨卡托投影，而是一个被 EPSG（European Petroleum Survey Group）称为伪墨卡托的投影方法，这个伪墨卡托投影方法的大名是 Popular Visualization Pseudo Mercator，PVPM。 因为这个坐标系统是 Google Map 最先使用的，或者更确切地说，是Google 最先发明的。在投影过程中，将表示地球的参考椭球体近似的作为正球体处理（正球体半径 R = 椭球体半长轴 a）。在 ArcGIS 中这个坐标系叫 WGS 1984 Web Mercator (Auxiliary Sphere)。Auxiliary Sphere 就是在告知你，这个坐标在投影过程中，将椭球体近似为正球体做投影变换，虽然基准面是WGS 1984 椭球面。

OpenLayers:900913 由于得不到官方的认证ID，Google为Web Mercator 任性地制定了这个ID，自娱自乐。

从技术角度看是有原因的。基准面被篡改后，本来是等角投影的Mercator坐标变换算法，不再等角了，而是近似等角，也就是出现角度变形。这种变形势必影响了坐标的精度。

Web Mercator 在 Web 地图领域被广泛使用，这个坐标系就名声大噪。尽管这个坐标系由于精度问题一度不被GIS专业人士接受，但最终 EPSG 还是给了 WKID:3857。


高斯-克吕格投影（Gauss Kruger）

我们国家的投影坐标系主要采用高斯-克吕格投影（Gauss Kruger），分为6度和3度分带投影，1:2.5万~1:50万比例尺地形图采用经差6度分带，1:1万比例尺的地形图采用经差3度分带。

6度分带：从本初子午线（prime meridian）开始，按经差6度为一个投影带自西向东划分，全球共分60个投影带，中国跨13-23带；

3度分带：是从东经1度30分经线（1.5°）开始，按经差3度为一个投影带自西向东划分，全球共分120个投影带，中国跨25-45带。

以西安80坐标为例，在ArcGIS中的投影坐标系中我们可以看到几种不同的命名方式：

- Xian 1980 3 Degree GK CM 102E：中央经线为102度的无带号的西安80 3度分带
- Xian 1980 3 Degree GK Zone 34：表示西安1980 3度分带中的34度带
- Xian 1980 GK Zone 13：西安80 6度分带中的13度带
- Xian 1980 GK Zone 13N / Xian 1980 GK CM 75E：中央经线为75度的无带号的西安80 6度分带



- 投影坐标系（X,Y坐标）

- 地理坐标系（经纬度坐标）
	+ GCS_Beijing_1954（Krasovsky_1940）
	+ GCS_Xian_1980（IAG_75）
	+ GCS_WGS_1984（WGS_1984）
	+ GCS_CN_2000（CN_2000）


### 软件标准

#### 软件类库

##### 几何基础类库

代表： JTS（Java）， GEOS（C++）， Shapely（Python）

##### 数据源实现

代表：PostGIS（PostgreSQL），MySQL Spatial

##### 中间件

代表：GeoTools（Java）中包括Filter、坐标转换、GML。

##### WMS/WFS服务器

代表： GeoServer（Java），MapServer（PHP）

##### 客户端

代表：OpenLayers/MapBuilder（JavaScript），uDig（Java），QGIS（C++）

#### Shapefile

ESRI的Shapefile格式是GIS矢量文件格式的事实标准，通常由.shp, .shx, .prj, .dbf等文件组成。OpenGIS的实现软件普遍支持Shapefile的读写。Shapefile在GeoServer中可以直接作为数据源，但是这种方式并不被推荐，原因很简单，基于文件的数据源可能造成性能不佳和数据丢失。

#### GML

GML是OpenGIS的标准规范之一，它基于xml描述地理数据。于Shapefile相比，xml更容易读写，易于在网络中以各种形式传播。同时，xml还具有可读性，人可以理解和辨识。GeoTools实现了GMLDataStore，因此在GeoServer中GML也可以直接作为数据源（需要下载GML扩展）。同时，GML的数据源为数据源动态化提供了实现的思路和可能性。

#### PostGIS

PostGIS是加拿大Refractions公司支持的开源项目，它为开源数据库PostgreSQL提供了空间支持。PostGIS安装后，PostgreSQL中出现一个模版数据库，新建空间数据库时只需以PostGIS为模版即可。PostGIS在SQL级别上实现了基本的空间运算功能。另外绝大多数开源GIS软件（即使是不严格遵守OpenGIS标准的）都支持PostGIS数据表的直接载入，读写等功能。毋庸置疑，PostGIS是OpenGIS数据源最佳实现。

#### MySQL Spatial

MySQL从MySQL4.0开始加入了Spatial扩展功能，实现了OpenGIS规定的几何数据类型，在SQL中的简单空间运算。但是从4.0之后到现在，MySQL的Spatial部分一直没有继续的更新和增强。加上早先MySQL在SQL上对空间运算支持的不完善（只支持基于最小外接矩形的关系判断），所以MySQL是开源数据源中一个不太让人满意的选择。不过由于MySQL在小型项目上的广泛引用，在一些情况下也是可以以MySQL为数据源的。

